# 规范以及注意事项

​	**重要：通过版本控制工程修改数据库，提交数据库变更一定要本地执行验证通过！！！**

- 数据库变更需提交 changeSet
- ChangeSet id 使用 [日期]-[姓名]-[序号]，如 20210603-shixiong-1（目的：合并代码的时候序号不冲突）
- sql 禁止包含 schema 名称 （目的：真正部署的时候 库和用户都不一定是 VOSP）
- 已经部署至测试及预发环境的 ChangeSet 严禁修改。（原因：框架限制历史SQL不能修改，改了之后校验和变化会执行失败）
- 数据库初始化数据的 sql 在 sql/data 目录下，初始化数据在开发时不放入 changlog，每一版本单表仅有一个初始化数据的 SQL 文件即可，可直接修改，禁止在之前版本的初始化数据中直接修改。（原因：初始化数据变更频繁不适合用版本控制，更适合手动执行，什么情况下可用：初始化数据确定不变了，上线，可放入 changset 直接执行）
- 如果多张表的改动 每张表是一个单独的 sqlFile，并且要在 comments 里写明变更点
- changelog.yaml 起名规则跟需求版本号保持一致， 例如v1.6 需求 changelog 为 changelog-1.6.yaml。上线之后有BUG 需要提 SQL 修复的话，小版本号升级，例如 changelog-1.6.1.yaml。
- 不要随便升级项目liquibase版本，特别是大版本升级。不同版本 ChangeSet MD5SUM的算法不一样。

# 目录规则

- 按版本创建目录 例如 1.2.0 ，每个版本的 sql 放在对应版本文件夹下, 可新增模块文件夹，文件名需以数据库表名(大写)开头， 后跟数字，从100开始，并且按序递增: （目的：是为了一目了然看到 SQL 执行的先后顺序，并且同一张表的放在一块）

- 文件目录结构如下
  - 1.2.0
    - customer
      - CUSTOMER_100.sql
      - CUSTOMER_101.sql
    - article
      - ARTICLE_100.sql
      - ARTICLE_101.sql
      - ...
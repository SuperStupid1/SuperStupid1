docker pull registry.docker-cn.com/library/elasticsearch


//修改容器内存大小，否则内存不够无法启动

docker run -e ES_JAVA_OPTS="-Xms512m -Xmx512m" -d -p 9200:9200 -p 9300:9300 --name elasticsearch  elasticsearch  


然后我们的9300是不能访问的，因为他不让我们访问我们需要修改配置文件，但是文件在内存中运行，所以我们先把配置文件复制出来改掉然后再运行

docker exec -it  elasticsearch /bin/bash

进入容器内部

cd config 
进入配置文件复制他的路径
/usr/share/elasticsearch/config

然后找到他的yml配置文件

/usr/share/elasticsearch/config/elasticsearch.yml

exit退出

我们有这个路径了我们把他的文件复制出来

docker cp elasticsearch:/usr/share/elasticsearch/config/elasticsearch.yml  /usr/share/elasticsearch.yml

复制到本地的 /usr/share/elasticsearch.yml

然后我们编辑他

vim /usr/share/elasticsearch.yml

将他第二行的注释去掉
然后保存退出

ok

然后我们将以前的启动的容器停止掉


docker run --name=elasticsearch -p 9200:9200 -p 9300:9300 -v /usr/share/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml myelasticsearch



docker run -e ES_JAVA_OPTS="-Xms256m -Xmx256m" -di --name=elasticsearch -p 9200:9200 -p 9300:9300 -v /usr/share/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml myelasticsearch

docker run -e ES_JAVA_OPTS="-Xms256m -Xmx256m" -di --name=elasticsearch -p 9200:9200 -p 9300:9300  elasticsearch


elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v5.6.12/elasticsearch-analysis-ik-5.6.12.zip



curl -H 'Content-Type: application/json'  -XGET 'localhost:9200/_analyze?pretty' -d '{"text":"白俊遥技术博客"}'


docker cp ik elasticsearch:/usr/share/elasticsearch/plugins/











Head插件安装

docker pull mobz/elasticsearch-head:5


KiBana
docker pull docker.elastic.co/kibana/kibana:5.6.12

docker run -it -d -e ELASTICSEARCH_URL=http://39.108.158.33:9200 --name kibana -p 5601:5601 docker.elastic.co/kibana/kibana:6.7.0




docker run --rm -p 5601:5601 --link elasticsearch-db:elasticsearch -e ELASTICSEARCH_URL=http://localhost:9200 --name kibana kibana
# 什么是JMM内存模型?

​		Java虚拟机规范中定义了Java内存模型（Java Memory Model，JMM），用于屏蔽掉各种硬件和操作系统的内存访问差异，以实现让Java程序在各种平台下都能达到一致的并发效果，JMM规范了Java虚拟机与计算机内存是如何协同工作的：规定了一个线程如何和何时可以看到由其他线程修改过后的共享变量的值，以及在必须时如何同步的访问共享变量。

​		原始的Java内存模型存在一些不足，因此Java内存模型在Java1.5时被重新修订。这个版本的Java内存模型在Java8中仍然在使用。

​		简单的来说，JMM内存模型就是提供给我们Java虚拟机的内存模型，用于控制JVM的内存数据，以及多线程的数据访问。

# JMM内存模型

​		JMM定义了Java 虚拟机(JVM)在计算机内存(RAM)中的工作方式。JVM是整个计算机虚拟模型，所以JMM是隶属于JVM的。从抽象的角度来看，JMM定义了线程和主内存之间的抽象关系：线程之间的共享变量存储在主内存（Main Memory）中，每个线程都有一个私有的本地内存（Local Memory），本地内存中存储了该线程以读/写共享变量的副本。本地内存是JMM的一个抽象概念，并不真实存在。它涵盖了缓存、写缓冲区、寄存器以及其他的硬件和编译器优化。

​		那么也就是说，我们Java线程在执行操作的时候，每个线程都是有一个私有的本地内存的，共享变量是存储在主存中的，我们的线程每次从主内存中读取共享变量数据，然后加载到本地的Local Memory中，然后各个线程对本地的Local Memory内存数据进行操作，然后再写回到主内存当中。

​		结构图如下：

![](https://blog-kang.oss-cn-beijing.aliyuncs.com/1606962637321.png)		